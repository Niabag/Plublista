<!DOCTYPE html>
<html>
<head><title>Export Logo PNG</title></head>
<body style="margin:40px;font-family:Arial;background:#888">
  <h2>Logo SiteOnWeb.fr - Centre</h2>
  <p>1. Chargez votre image originale</p>
  <input type="file" id="fileInput" accept="image/*" style="margin-bottom:10px;font-size:16px">
  <br>
  <p>2. Ajustez la taille du ".fr"</p>
  <div style="display:flex;gap:20px;margin-bottom:10px;flex-wrap:wrap">
    <label>Taille .fr: <input type="range" id="fontSize" min="5" max="50" value="22" style="width:200px"> <span id="fsVal">22%</span></label>
    <label>Decalage Y: <input type="range" id="yOff" min="-20" max="20" value="0" style="width:200px"> <span id="yVal">0px</span></label>
    <label>Espacement: <input type="range" id="gap" min="-200" max="40" value="2" style="width:200px"> <span id="gVal">2px</span></label>
  </div>
  <canvas id="canvas" style="border:1px dashed #ccc;background:repeating-conic-gradient(#ccc 0% 25%, white 0% 50%) 50%/20px 20px;max-width:100%"></canvas>
  <br><br>
  <button onclick="doDownload()" id="dlBtn" disabled style="padding:12px 24px;font-size:16px;background:#DA2626;color:white;border:none;border-radius:8px;cursor:pointer;opacity:0.5">
    Telecharger PNG transparent
  </button>
  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let loadedImg = null;

    const fsSlider = document.getElementById('fontSize');
    const ySlider = document.getElementById('yOff');
    const gSlider = document.getElementById('gap');

    function redraw() {
      if (!loadedImg) return;
      const img = loadedImg;

      const frSize = Math.round(img.height * (parseInt(fsSlider.value) / 100));
      ctx.font = '900 ' + frSize + 'px "Arial Black", "Helvetica Neue", Impact, sans-serif';
      const frMetrics = ctx.measureText('.fr');
      const frWidth = frMetrics.width;
      const gapPx = parseInt(gSlider.value);

      // Canvas wider to fit original + gap + .fr, centered
      const totalWidth = img.width + gapPx + frWidth;
      const padding = 20;
      canvas.width = totalWidth + padding * 2;
      canvas.height = img.height;
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Center: draw original image
      const imgX = (canvas.width - totalWidth) / 2;
      ctx.drawImage(img, imgX, 0);

      // Draw .fr right after
      const yOff = parseInt(ySlider.value);
      ctx.font = '900 ' + frSize + 'px "Arial Black", "Helvetica Neue", Impact, sans-serif';
      ctx.fillStyle = '#DA2626';
      ctx.textBaseline = 'middle';
      ctx.fillText('.fr', imgX + img.width + gapPx, img.height / 2 + yOff);

      document.getElementById('fsVal').textContent = fsSlider.value + '%';
      document.getElementById('yVal').textContent = ySlider.value + 'px';
      document.getElementById('gVal').textContent = gSlider.value + 'px';
    }

    fsSlider.addEventListener('input', redraw);
    ySlider.addEventListener('input', redraw);
    gSlider.addEventListener('input', redraw);

    document.getElementById('fileInput').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (ev) => {
        const img = new Image();
        img.onload = () => {
          loadedImg = img;
          redraw();
          document.getElementById('dlBtn').disabled = false;
          document.getElementById('dlBtn').style.opacity = '1';
        };
        img.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    });

    function doDownload() {
      const link = document.createElement('a');
      link.download = 'SiteOnWeb-fr.png';
      link.href = canvas.toDataURL('image/png');
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</body>
</html>